<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="rgb(255,255,255)"><meta http-equiv=x-ua-compatible content="ie=edge"><title>MCPS HSF 2023 Writeup &#183; Luke Griffith</title><meta name=title content="MCPS HSF 2023 Writeup &#183; Luke Griffith"><meta name=description content="A walkthrough of all the challenges in MCPSF 2023"><link rel=canonical href=https://lukegriffith.me/posts/writeups/mcpshsf/><link type=text/css rel=stylesheet href=/css/main.bundle.min.827e4067f785eb8991b29db972c66513a2555b27ab79607dadc6efd017da4df0fd429efe9ed49a1fc101da2d1cb711816bb8efc4e01baaf9eeb352b258c9f887.css integrity="sha512-gn5AZ/eF64mRsp25csZlE6JVWyereWB9rcbv0BfaTfD9Qp7+ntSaH8EB2i0ctxGBa7jvxOAbqvnus1KyWMn4hw=="><script type=text/javascript src=/js/appearance.min.c6198a5ecbc6c7b35a8568d29315f50cf5d775d4461c515a476359767f1a745c245aa83fa96b0c7d83da976cf77481e1fc29537a2391a53ffe69a991638802e6.js integrity="sha512-xhmKXsvGx7NahWjSkxX1DPXXddRGHFFaR2NZdn8adFwkWqg/qWsMfYPal2z3dIHh/ClTeiORpT/+aamRY4gC5g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.6d78c827ca7bcbf72056dbf698bf9aeb759a08966686187deb23f5949f73eca5f39b461284900cdfc08e2976d99eb80a8663648de778ba2a83e633ae16dbfc25.js integrity="sha512-bXjIJ8p7y/cgVtv2mL+a63WaCJZmhhh96yP1lJ9z7KXzm0YShJAM38COKXbZnrgKhmNkjed4uiqD5jOuFtv8JQ==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="MCPS HSF 2023 Writeup"><meta property="og:description" content="A walkthrough of all the challenges in MCPSF 2023"><meta property="og:type" content="article"><meta property="og:url" content="https://lukegriffith.me/posts/writeups/mcpshsf/"><meta property="article:section" content="posts"><meta property="og:site_name" content="Luke Griffith"><meta name=twitter:card content="summary"><meta name=twitter:title content="MCPS HSF 2023 Writeup"><meta name=twitter:description content="A walkthrough of all the challenges in MCPSF 2023"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"My Blog","name":"MCPS HSF 2023 Writeup","headline":"MCPS HSF 2023 Writeup","description":"A walkthrough of all the challenges in MCPSF 2023","abstract":"A detailed walkthrough of all the challenges in MCPSF 2023. It also includes who killed Chance\u0026hellip;","url":"https:\/\/lukegriffith.me\/posts\/writeups\/mcpshsf\/","author":{"@type":"Person","name":"Luke Griffith"},"keywords":["writeups","ctfs"],"mainEntityOfPage":"true","wordCount":"5367"}]</script><meta name=author content="Luke Griffith"><link href=https://github.com/just-luk rel=me><link href=https://linkedin.com/in/lukeg123 rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10"><nav class="flex items-start justify-between sm:items-center"><div class="z-40 flex flex-row items-center"><a href=/ class=mr-2><img src=/icon.png width=50 height=50 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left" alt="Luke Griffith"></a></div><label id=menu-button for=menu-controller class="block sm:hidden"><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-full h-full m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex flex-col w-full px-6 py-6 mx-auto overflow-visible list-none max-w-7xl ltr:text-right rtl:text-left sm:px-14 sm:py-10 sm:pt-10 md:px-24 lg:px-32"><li class=mb-1><span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class="mb-1 group"><a href=/posts/ title="My Blog"><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Blog</span></a></li><li class="mb-1 group"><a href=/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="mb-1 group"><button id=search-button-1 title="Search (/)">
<span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></div></label><ul class="flex-row hidden list-none ltr:text-right rtl:text-left sm:flex"><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/posts/ title="My Blog"><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Blog</span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><button id=search-button-2 title="Search (/)">
<span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Luke Griffith</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>My Blog</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/writeups/mcpshsf/>MCPS HSF 2023 Writeup</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">MCPS HSF 2023 Writeup</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#quick-note>Quick Note</a></li><li><a href=#challenge-graph>Challenge Graph</a></li><li><a href=#twitter>Twitter</a><ul><li><a href=#getting-started>Getting Started</a></li><li><a href=#caesar-cipher>Caesar Cipher</a></li><li><a href=#xor>Xor</a></li><li><a href=#base64>Base64</a></li><li><a href=#corncobs-website>Corncob&rsquo;s Website</a></li><li><a href=#other-clues>Other Clues</a></li></ul></li><li><a href=#facebook>Facebook</a><ul><li><a href=#dead-chance>Dead Chance</a></li><li><a href=#corncobs-office>Corncob&rsquo;s Office</a></li><li><a href=#pan-image>Pan Image</a></li><li><a href=#robot-images>Robot Images</a></li><li><a href=#longs-madlibs>Long&rsquo;s Madlibs</a></li><li><a href=#other-clues-1>Other Clues</a></li></ul></li><li><a href=#chances-blog>Chance&rsquo;s Blog</a><ul><li><a href=#lockpicking>Lockpicking</a></li><li><a href=#unknown-encryption>Unknown Encryption</a></li><li><a href=#latke-recipe>Latke Recipe</a></li><li><a href=#sql-log>SQL Log</a></li></ul></li><li><a href=#fileshare>Fileshare</a><ul><li><a href=#encrypted-zip>Encrypted Zip</a></li><li><a href=#spectrogram>Spectrogram</a></li><li><a href=#pcap-logins>PCAP Logins</a></li><li><a href=#broken-png>Broken PNG</a></li></ul></li><li><a href=#virtual-machine>Virtual Machine</a><ul><li><a href=#chrome-history>Chrome History</a></li><li><a href=#git-repo>Git Repo</a></li></ul></li><li><a href=#secret-chat>Secret Chat</a><ul><li><a href=#invisible-message>Invisible Message</a></li><li><a href=#keyboard-pcap>Keyboard PCAP</a></li><li><a href=#memory-dump>Memory Dump</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose grow"><h2 id=quick-note class="relative group">Quick Note <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#quick-note aria-label=Anchor>#</a></span></h2><p>MCPS HSF (Montgomery County Public Schools High School Forensics) is a CTF competition for high school students in Montgomery County, Maryland. This year, it was held on March 14th, 2023. All challenges were generated using <a href=https://github.com/CTFg/chalgen target=_blank rel="noreferrer noopener">chalgen</a>, a tool we wrote to generate CTF challenges. If you want to see the source code for this competition, visit the <a href=https://github.com/CTFg/chalgen/tree/master/competitions/mcpshsf-2023 target=_blank rel="noreferrer noopener">competitions/mcpshsf-2023</a> folder. The competition also used <a href=https://github.com/CTFg/CTFg target=_blank rel="noreferrer noopener">CTFg</a>, a custom web application we wrote for HSFs, to allow competitors to connect and enter evidence. If you like these types of competitions, please give us a star on GitHub!</p><div class="flex flex-row justify-center items-center"><h4>CTFg</h4><h1 class=opacity-0>fillertextfil</h1><h4>Chalgen</h4></div><div><div class="flex flex-row justify-center items-center"><a href=https://github.com/CTFg/CTFg><img src="https://img.shields.io/github/stars/CTFg/CTFg?style=for-the-badge&logo=Github"></a><h1 class=opacity-0>fillerte</h1><a href=https://github.com/CTFg/chalgen><img src="https://img.shields.io/github/stars/CTFg/chalgen?style=for-the-badge&logo=Github"></a></div><p>The challenges were all based on real-world forensics challenges, but with a twist. The twist was that the challenges were all based on the same story, and the challenges were all interconnected. The goal was to solve all the challenges and figure out who killed Chance.</p><h2 id=challenge-graph class="relative group">Challenge Graph <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#challenge-graph aria-label=Anchor>#</a></span></h2><p>Here&rsquo;s a graph of all the challenges for MCPS HSF 2023:
<script src=//unpkg.com/force-graph></script>
<script src=//unpkg.com/d3-quadtree></script>
<script src=//unpkg.com/d3-force></script><div id=graph></div><script>data={nodes:[{id:"Twitter",group:1},{id:"Caesar Cipher",group:2},{id:"Xor",group:2},{id:"Base64",group:2},{id:"Corncob's Website",group:2},{id:"Facebook",group:2},{id:"Chance's Blog",group:2},{id:"Vacation Image",group:2},{id:"Secret Chat",group:2},{id:"Dead Chance",group:3},{id:"Corncob's Office",group:3},{id:"Pan Image",group:3},{id:"Robot Images",group:3},{id:"Fileshare",group:3},{id:"Long's Madlibs",group:3},{id:"Lockpicking",group:3},{id:"Unknown Encryption",group:3},{id:"Latke Recipe",group:3},{id:"SQL Log",group:3},{id:"Invisible Message",group:3},{id:"Keyboard PCAP",group:3},{id:"Memory Dump",group:3},{id:"Encrypted Zip",group:4},{id:"Spectrogram",group:4},{id:"PCAP Logins",group:4},{id:"Broken PNG",group:4},{id:"Virtual Machine",group:4},{id:"Chrome History",group:5},{id:"Git Repo",group:5}],links:[{source:"Twitter",target:"Caesar Cipher",value:1},{source:"Twitter",target:"Xor",value:1},{source:"Twitter",target:"Base64",value:1},{source:"Twitter",target:"Corncob's Website",value:1},{source:"Twitter",target:"Facebook",value:1},{source:"Twitter",target:"Chance's Blog",value:1},{source:"Twitter",target:"Vacation Image",value:1},{source:"Twitter",target:"Secret Chat",value:1},{source:"Facebook",target:"Dead Chance",value:1},{source:"Facebook",target:"Corncob's Office",value:1},{source:"Facebook",target:"Pan Image",value:1},{source:"Facebook",target:"Robot Images",value:1},{source:"Facebook",target:"Fileshare",value:1},{source:"Facebook",target:"Long's Madlibs",value:1},{source:"Chance's Blog",target:"Lockpicking",value:1},{source:"Chance's Blog",target:"Unknown Encryption",value:1},{source:"Chance's Blog",target:"Latke Recipe",value:1},{source:"Chance's Blog",target:"SQL Log",value:1},{source:"Secret Chat",target:"Invisible Message",value:1},{source:"Secret Chat",target:"Keyboard PCAP",value:1},{source:"Secret Chat",target:"Memory Dump",value:1},{source:"Fileshare",target:"Encrypted Zip",value:1},{source:"Fileshare",target:"Spectrogram",value:1},{source:"Fileshare",target:"PCAP Logins",value:1},{source:"Fileshare",target:"Broken PNG",value:1},{source:"Fileshare",target:"Virtual Machine",value:1},{source:"Virtual Machine",target:"Chrome History",value:1},{source:"Virtual Machine",target:"Git Repo",value:1}]};const getColor=e=>{switch(e.group){case 1:return"#C77DFF";case 2:return"#ff8fa3";case 3:return"#9D4EDD";case 4:return"#D56AA0";case 5:return"#7B2CBF";default:return"#000000"}},Graph=ForceGraph()(document.getElementById("graph")).graphData(data).nodeId("id").linkSource("source").linkTarget("target").width(575).height(550).backgroundColor("dark: black white").linkColor(()=>"#848482").linkDirectionalArrowLength(10).nodeCanvasObject((e,t,n)=>{const o=e.id,s=14/n;t.font=`${s}px ui-monospace`;const i=t.measureText(o).width,a=[i,s].map(e=>e+s*.2);t.textAlign="center",t.textBaseline="middle",t.fillStyle=getColor(e),t.fillText(o,e.x,e.y),e.__bckgDimensions=a});Graph.cooldownTime(1/0).d3Force("collide",d3.forceCollide(Graph.nodeRelSize()+20)),Graph.onEngineStop(()=>Graph.zoomToFit(400))</script></p><p>I will now go through each challenge, along with the evidence on each website.</p><h2 id=twitter class="relative group">Twitter <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#twitter aria-label=Anchor>#</a></span></h2><h3 id=getting-started class="relative group">Getting Started <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#getting-started aria-label=Anchor>#</a></span></h3><p>From the challenge document, we are given the username <code>sadamana</code>, the password <code>s4d4m4n4</code>, and url <a href=https://twitter-flask.chals.mcpshsf.com/ target=_blank rel="noreferrer noopener">https://twitter-flask.chals.mcpshsf.com/</a>. We can log in with these credentials, and we are greeted with the following page:<figure><img class="mx-auto my-0 rounded-md" src=/entryflag.png alt=entry></figure>Hooray! We got our first flag of <code>flag{you_found_twitter}</code>! We can now login using the credentials mentioned above and start looking for more clues.</p><h3 id=caesar-cipher class="relative group">Caesar Cipher <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#caesar-cipher aria-label=Anchor>#</a></span></h3><p>Scrolling through the tweets, we find this suspicious tweet from Long:</p><blockquote><p>sw mywsxq kpdob iye pvkq{k_fobi_lkcsm_mkockb_mszrob}</p></blockquote><p>This text was probably encrypted with a Caesar cipher, because it looks like each letter was shifted. After using <a href=https://www.dcode.fr/caesar-cipher target=_blank rel="noreferrer noopener">this website</a> to decode it, we get the following message:</p><pre tabindex=0><code>im coming after you flag{a_very_basic_caesar_cipher}
</code></pre><p>Very interesting message&mldr; We now have a new flag of <code>flag{a_very_basic_caesar_cipher}</code> and new suspect of Long. Let&rsquo;s keep looking for more clues.</p><h3 id=xor class="relative group">Xor <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#xor aria-label=Anchor>#</a></span></h3><p>Looking through the tweets, we also find this tweet from Corncob:</p><pre tabindex=0><code>I learned about new cryptography technique, anyone want to take a byte?
08020f09151d5d0a5f035d001a5a1c17311c5e0d051300011e0b424e030f170c0b4e060be281b71d4e041b1d1a4e1e020f170700094e260b0f1c1a061c010d054e190607020b4e27e281b7034e060b1c0b4e0a010700094e0f02024e06071d4e19011c054e08011c4e060703
</code></pre><p>This looks like a hex string, but it doesn&rsquo;t decode to anything. However, if we try brute forcing an xor key using <a href=https://cyberchef.org/ target=_blank rel="noreferrer noopener">this website</a>, we get the following message:</p><pre tabindex=0><code>flag{s3d1m3nt4ry_r0ck} 
nope, maybe he is just playing Hearthrock while I am here doing all his work
</code></pre><p>This gives us a new flag of <code>flag{s3d1m3nt4ry_r0ck}</code>. We also suspect Corncob, as he seems angry at Chance for giving him too much work. However, we still need more evidence.</p><h3 id=base64 class="relative group">Base64 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#base64 aria-label=Anchor>#</a></span></h3><p>This tweet from Karst also looks important:</p><pre tabindex=0><code>dSA9IGthcnN0LCBwYXNzID0gRVNTX2Ywcl90aDNfdzFuCmZsYWd7Y3IzZDVfNHIzX3U1M2Z1MV93MHd9
</code></pre><p>Because of the characters in the string, it is probably encoded with Base64. After decoding it with <a href=https://www.base64decode.org/ target=_blank rel="noreferrer noopener">this website</a>, we get this message:</p><pre tabindex=0><code>u = karst, pass = ESS_f0r_th3_w1n
flag{cr3d5_4r3_u53fu1_w0w}
</code></pre><p>It&rsquo;s a new flag! <code>flag{cr3d5_4r3_u53fu1_w0w}</code>. We also got some new credentials for Karst. We can now login with these credentials and look for even more clues. Looking in Karst&rsquo;s direct messages, we find that he messaged himself with his Facebook credentials:</p><blockquote><p>fb creds so i dont forget username: Karst, password: 3ddy_Curr3nT5</p></blockquote><p>In HSFs, it&rsquo;s important to note any credentials found, as they may be useful later. In this case, we can use these credentials to login to Facebook.</p><h3 id=corncobs-website class="relative group">Corncob&rsquo;s Website <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#corncobs-website aria-label=Anchor>#</a></span></h3><p>Corncob mentions that his credentials on his website <a href=http://corncobs-sus-website.chals.mcpshsf.com target=_blank rel="noreferrer noopener">http://corncobs-sus-website.chals.mcpshsf.com</a> and that finding them is related to robots. This is a hint that we need to look at the robots.txt file. After looking at the robots.txt file, we find this:</p><pre tabindex=0><code>User-agent: *
Disallow: flag{domo_arigato}
User: corncob, pass: L4tk3_M4f14_L0rd_123
</code></pre><p>We now have a new flag of <code>flag{domo_arigato}</code> and new credentials for Corncob. We can login to Twitter with these credentials and look
in Corncob&rsquo;s DMs for more clues. In Corncob&rsquo;s DMs, we find a new <a href=https://secret-chat.chals.mcpshsf.com/ target=_blank rel="noreferrer noopener">website</a>. Unfortunately, none of our credentials work on this website, so let&rsquo;s save this site for later.</p><p>We also find that Long begged Corncob for laktes, and Corncob refused. This could show that Long has some motive to kill Chance, as chance sells laktes. However, the DMs also show that Chance is Corncob&rsquo;s boss, and Corncob is angry at Chance for making him do too much work. This means Corncob is also a suspect.</p><h3 id=other-clues class="relative group">Other Clues <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#other-clues aria-label=Anchor>#</a></span></h3><p>This Tweet from chance looks important:</p><blockquote><p>i just launched my new cooking blog! Check it out! <a href=http://jekyll-blog.chals.mcpshsf.com target=_blank rel="noreferrer noopener">http://jekyll-blog.chals.mcpshsf.com</a></p></blockquote><p>This website looks like Chance&rsquo;s cooking blog. We also find that Long is angry at Chance for not giving him laktes, as he says:</p><blockquote><p>bruh if i dont get some latkes rn imma throw hands</p></blockquote><p>This could be a motive for Long to kill Chance. In addition, Chance appears to part of latke cartel. We also find another site, <a href=https://facebook-django.chals.mcpshsf.com target=_blank rel="noreferrer noopener">Facebook</a>. This site looks like the Facebook site that Karst has credentials for. Let&rsquo;s explore this site for more clues.</p><h2 id=facebook class="relative group">Facebook <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#facebook aria-label=Anchor>#</a></span></h2><h3 id=dead-chance class="relative group">Dead Chance <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dead-chance aria-label=Anchor>#</a></span></h3><p>Upon logging into Facebook, we find a picture of Chance&rsquo;s dead body with a pan next to it. This image is shown here:<figure><img class="mx-auto my-0 rounded-md" srcset="/chance_hudf214759a933a86f83df161800ddc85a_369175_330x0_resize_q75_box.jpg 330w,
/chance_hudf214759a933a86f83df161800ddc85a_369175_660x0_resize_q75_box.jpg 660w,
/chance_hudf214759a933a86f83df161800ddc85a_369175_1024x0_resize_q75_box.jpg 1024w,
/chance_hudf214759a933a86f83df161800ddc85a_369175_1320x0_resize_q75_box.jpg 2x" src=/chance_hudf214759a933a86f83df161800ddc85a_369175_660x0_resize_q75_box.jpg alt=Image></figure>There also appears to a fingerprint on the pan. These could be clues to who killed Chance. Let&rsquo;s also look at the metadata of the image. We can do this by running <code>exiftool</code> on the image. We get the following output:</p><pre tabindex=0><code>ExifTool Version Number         : 12.40
File Name                       : chance.jpg
Directory                       : .
File Size                       : 361 KiB
File Modification Date/Time     : 2023:03:25 15:54:35-04:00
File Access Date/Time           : 2023:03:25 15:59:49-04:00
File Inode Change Date/Time     : 2023:03:25 15:54:41-04:00
File Permissions                : -rwxrwxrwx
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Exif Byte Order                 : Big-endian (Motorola, MM)
Image Description               : Screenshot
Orientation                     : Horizontal (normal)
X Resolution                    : 57
Y Resolution                    : 57
Resolution Unit                 : cm
Software                        : GIMP 2.10.32
Modify Date                     : 2023:03:07 04:46:43
Artist                          : ZmxhZ3toZV9kZWFkX29oX25vfQ==
User Comment                    : Screenshot
Color Space                     : sRGB
Exif Image Width                : 1814
Exif Image Height               : 1364
GPS Version ID                  : 0.0.0.1
GPS Latitude Ref                : Unknown (E)
GPS Longitude Ref               : Unknown (S)
Subfile Type                    : Reduced-resolution image
Compression                     : JPEG (old-style)
Photometric Interpretation      : YCbCr
Samples Per Pixel               : 3
Thumbnail Offset                : 593
Thumbnail Length                : 10216
Comment                         : Screenshot
Image Width                     : 1814
Image Height                    : 1364
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 1814x1364
Megapixels                      : 2.5
Thumbnail Image                 : (Binary data 10216 bytes, use -b option to extract)
GPS Latitude                    : 19 deg 54&#39; 36.24&#34; N
GPS Longitude                   : 155 deg 35&#39; 55.44&#34; E
GPS Position                    : 19 deg 54&#39; 36.24&#34; N, 155 deg 35&#39; 55.44&#34; E
</code></pre><p>The artist field looks suspicious, and is likely base64 encoded. Using this <a href=https://www.base64decode.org/ target=_blank rel="noreferrer noopener">website</a>, we can decode the string. We get the following flag: <code>flag{he_dead_oh_no}</code>.</p><h3 id=corncobs-office class="relative group">Corncob&rsquo;s Office <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#corncobs-office aria-label=Anchor>#</a></span></h3><p>Scrolling down further, we find a post from Corncob. This post is shown here:</p><blockquote><p>guys i just wanted to say that my boss is an awful human being he never does any of his own work so i do all the dirty work and ngl im lowkey glad he&rsquo;s gone. Here&rsquo;s his office it&rsquo;s so gross and he just left for another party and i&rsquo;m here cleaning it up. Thanks for listening to my ted talk. <a href=http://chal-host.chals.mcpshsf.com/edited_photo.png target=_blank rel="noreferrer noopener">http://chal-host.chals.mcpshsf.com/edited_photo.png</a></p></blockquote><p>This makes Corncob a bigger suspect, as he is glad that Chance is gone. He also hates Chance for being lazy and giving him all the work. The image he posted is shown here:<figure><img class="mx-auto my-0 rounded-md" src=/office.png alt=Image></figure></p><p>To get more information about this image, let&rsquo;s run strings on it to see if anything pops up. Running <code>strings office.jpg</code> and looking for anything that looks like a flag, we find what we are looking for: <code>flag{n0t3p4d++_15_0ur_s4v10r}</code>.</p><h3 id=pan-image class="relative group">Pan Image <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pan-image aria-label=Anchor>#</a></span></h3><p>Hubbz also posted a picture of the pan that was next to Chance&rsquo;s body. This image is shown here:<figure><img class="mx-auto my-0 rounded-md" srcset="/pan_huf529b8843a816fa64ad5af6fa56b3843_161585_330x0_resize_box_3.png 330w,
/pan_huf529b8843a816fa64ad5af6fa56b3843_161585_660x0_resize_box_3.png 660w,
/pan_huf529b8843a816fa64ad5af6fa56b3843_161585_1024x0_resize_box_3.png 1024w,
/pan_huf529b8843a816fa64ad5af6fa56b3843_161585_1320x0_resize_box_3.png 2x" src=/pan_huf529b8843a816fa64ad5af6fa56b3843_161585_660x0_resize_box_3.png alt=Image></figure></p><p>This makes Hubbz a suspect, as Chance was killed with a pan. However, we need more evidence before we make a conclusion. Analyzing this image further with <code>zsteg</code>, we get the following output:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>b1,r,lsb,xy         .. text: <span style=color:#e6db74>&#34;?v7\n\&#34;QBVR@&#34;</span>
</span></span><span style=display:flex><span>b1,rgb,lsb,xy       .. text: <span style=color:#e6db74>&#34;58:flag{l0v3ly_sup3r_b3st_3nc0d1ng}username: k4r5t_t0p0gr4phy&#34;</span>
</span></span><span style=display:flex><span>b1,bgr,lsb,xy       .. file: OpenPGP Secret Key
</span></span><span style=display:flex><span>b2,r,lsb,xy         .. text: <span style=color:#e6db74>&#34;UUUUUUUUUUUUUUUUUUUUUUUUUUUT&#34;</span>
</span></span><span style=display:flex><span>b2,r,msb,xy         .. text: <span style=color:#e6db74>&#34;u]UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU&#34;</span>
</span></span><span style=display:flex><span>b2,g,lsb,xy         .. text: <span style=color:#e6db74>&#34;UUUUUUUUUUUUUUUUUUUUUUUUUUUT&#34;</span>
</span></span><span style=display:flex><span>b2,g,msb,xy         .. text: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;U&#34;</span> repeated <span style=color:#ae81ff>43</span> times<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>b2,b,lsb,xy         .. text: <span style=color:#e6db74>&#34;UUUUUUUUUUUUUUUUUUUUUUUUUUUT&#34;</span>
</span></span><span style=display:flex><span>b2,b,msb,xy         .. text: <span style=color:#e6db74>&#34;}WUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU&#34;</span>
</span></span><span style=display:flex><span>b2,rgb,msb,xy       .. text: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;U&#34;</span> repeated <span style=color:#ae81ff>132</span> times<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>b2,bgr,msb,xy       .. text: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;U&#34;</span> repeated <span style=color:#ae81ff>132</span> times<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>b2,abgr,msb,xy      .. text: <span style=color:#e6db74>&#34;wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW&#34;</span>
</span></span><span style=display:flex><span>b3,abgr,msb,xy      .. file: MPEG ADTS, layer I, v2, <span style=color:#ae81ff>256</span> kbps, Monaural
</span></span><span style=display:flex><span>b4,r,msb,xy         .. text: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;w&#34;</span> repeated <span style=color:#ae81ff>88</span> times<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>b4,g,msb,xy         .. text: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;w&#34;</span> repeated <span style=color:#ae81ff>87</span> times<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>b4,b,msb,xy         .. file: MPEG ADTS, layer I, v2, <span style=color:#ae81ff>112</span> kbps, <span style=color:#ae81ff>24</span> kHz, JntStereo
</span></span><span style=display:flex><span>b4,rgb,msb,xy       .. text: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;w&#34;</span> repeated <span style=color:#ae81ff>12</span> times<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>b4,bgr,msb,xy       .. text: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;w&#34;</span> repeated <span style=color:#ae81ff>12</span> times<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>This gives us our flag <code>flag{l0v3ly_sup3r_b3st_3nc0d1ng}</code> and a username, <code>k4r5t_t0p0gr4phy</code>, to store for a later part of the competition.</p><h3 id=robot-images class="relative group">Robot Images <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#robot-images aria-label=Anchor>#</a></span></h3><p>Unforunately, this challenge actually broke during the competition, so teams only got a partial flag. The challenge was to find the flag in the two images of a robot. Both images show the following robot:<figure><img class="mx-auto my-0 rounded-md" srcset="/robots_hu7ead41437c48f1185124391599b7e83c_1101622_330x0_resize_box_3.png 330w,
/robots_hu7ead41437c48f1185124391599b7e83c_1101622_660x0_resize_box_3.png 660w,
/robots_hu7ead41437c48f1185124391599b7e83c_1101622_1024x0_resize_box_3.png 1024w,
/robots_hu7ead41437c48f1185124391599b7e83c_1101622_1320x0_resize_box_3.png 2x" src=/robots_hu7ead41437c48f1185124391599b7e83c_1101622_660x0_resize_box_3.png alt=Robot></figure></p><p>Using this command <code>cmp -l _robots.png chal.png | gawk '{printf "%08X %02X %02X\n", $1, strtonum(0$2), strtonum(0$3)}'</code> we can find the differences between the two images. This gives us the following output:</p><pre tabindex=0><code>000437E1 1C 66
00047C41 3B 6C
0004C07F CD 61
0004D7F6 85 67
0005199F 66 7B
00056869 C2 35
00059665 5B 75
0005F418 D8 63
000614B6 64 68
00066C6C F0 5F
0006921B 4D 34
0006C56D 91 5F
000738E2 85 63
000745FB 3B 30
0007803E 6A 30
0007C0F6 FF 6C
00080058 3D 5F
00084A32 02 70
0008A15F F0 72
0008E8D5 2A 30
00091568 67 6A
0009636B 94 33
0009A75F 8D 63
0009CD2A CA 74
000A1A94 79 21
000A5913 25 21
000A9FBF 23 7D
000AE8C9 C2 70
000AFC4F 6D 61
000B2FCB ED 73
000B77FA 44 73
000BDFA5 FB 77
000BFF5D 32 6F
000C621B 01 72
000CA281 AC 64
000CC987 A9 3A
000D16D0 74 20
000D447E 78 79
000D7434 71 34
000DBF48 F5 7A
000E0F99 64 30
000E5462 B4 30
000E8466 6A 5F
000EB14C 7E 74
000EFBC1 A1 72
000F4BB6 7D 31
000F6800 5E 62
000FAD4E 96 75
000FF528 6C 74
00103D23 FA 34
00106E50 3A 72
0010BD7E 50 79
</code></pre><p>The bytes in the third column are the bytes that have been changed. Decoding these updated bytes as ASCII gives us the flag <code>flag{5uch_4_c00l_pr0j3ct!!}</code> and a password, <code>y4z00_tr1but4ry</code>, to use later.</p><h3 id=longs-madlibs class="relative group">Long&rsquo;s Madlibs <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#longs-madlibs aria-label=Anchor>#</a></span></h3><p>This post from Long gives a new website to explore:</p><blockquote><p>I made my first website! Go check it out and let me know if you like it <a href=http://madlibs.chals.mcpshsf.com target=_blank rel="noreferrer noopener">http://madlibs.chals.mcpshsf.com</a></p></blockquote><p>This website is a madlibs game, where you can fill in the blanks and get a story. Because our input is reflected back to us, we should test for a <a href=https://portswigger.net/web-security/server-side-template-injection target=_blank rel="noreferrer noopener">template injection attack</a>. Trying the string <code>{{ 7 + 7 }}</code> confirms that this is a template injection attack and gives us the template language, Jinja2. Running this payload <code>{{request.application.__globals__.__builtins__.__import__('os') .popen('ls').read()}}</code> gives us the files on the system:</p><pre tabindex=0><code>flag.txt letter.txt main.py static templates 
</code></pre><p>Running <code>{{request.application.__globals__.__builtins__.__import__('os') .popen('cat flag.txt').read()}}</code> gives us the flag: <code>flag{th1s_1s_a_t3mp14t3_f0r_fl4sk5_4nd_inj3ct1on5}</code>. We can also read the file <code>letter.txt</code> to get the following message:</p><blockquote><p>Dear Diary, I can&rsquo;t believe how upset I am right now. I asked Chance for some Latkes and he never responded! I was really looking forward to enjoying those crispy, delicious potato pancakes, and I was practically salivating at the thought of smothering them with sour cream and applesauce. Now, I&rsquo;m sitting here in my kitchen, feeling sorry for myself, and hungry as can be. I can&rsquo;t stop thinking about those latkes, and how amazing they would have tasted if only I had been able to get my hands on some potatoes. It&rsquo;s not fair, really. I mean, who runs out of latkes? I know it&rsquo;s silly to get so worked up over something as simple as food, but I can&rsquo;t help it. I was really looking forward to those latkes, and now I&rsquo;m just mad that I didn&rsquo;t get to enjoy them. I guess I&rsquo;ll just sulk in my room and try to forget about those delicious, crispy latkes that I missed out on. I might have to hit something if I don&rsquo;t get those latkes.</p></blockquote><p>This is more evidence that Long is the murderer, as he is so mad at Chance that he would hit something. This could mean that he has a strong enough motive to kill Chance.</p><h3 id=other-clues-1 class="relative group">Other Clues <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#other-clues-1 aria-label=Anchor>#</a></span></h3><p>First, looking at the comments on the Robot images, we find that someone stole Hubbz&rsquo;s pan:</p><blockquote><p>BRUH SOMEONE STOLE MY PAN OMG</p></blockquote><p>This clears Hubbz as a suspect, as the murder weapon was stolen from him.</p><p>Lastly, post from Karst gives a filesharing website, <a href=https://fileshare-flask.chals.mcpshsf.com target=_blank rel="noreferrer noopener">htts://fileshare-flask.chals.mcpshsf.com</a>. Using the username for the pan image, <code>k4r5t_t0p0gr4phy</code>, and the password from the robot images, <code>y4z00_tr1but4ry</code>. We can log in and look for more clues.</p><h2 id=chances-blog class="relative group">Chance&rsquo;s Blog <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#chances-blog aria-label=Anchor>#</a></span></h2><p>Before we look at the filesharing site, let&rsquo;s go back and investigate Chance&rsquo;s blog that he posted to Twitter.</p><h3 id=lockpicking class="relative group">Lockpicking <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#lockpicking aria-label=Anchor>#</a></span></h3><p>On his blog, we see that Chance locked a key with a bike lock:</p><blockquote><p>I locked the key with a bike lock and I don’t know the combination :(</p></blockquote><p>After visiting the HT230 Lab, we get access to a bike lock to crack. To pick this lock, we can use the gap between the rings of the bike lock to determine if a number is right or not. The step to pick are are:</p><ol><li>Move through each number in the first ring, pulling the lock each time</li><li>The number that is right will have a noticeable gap between the rings</li><li>Repeat steps 1 and 2 for the second, third, and fourth rings.</li></ol><p>Upon opening the bike lock, we get the following information:</p><pre tabindex=0><code>flag{l33t_l0ckp1ck1ng_br0}
the key is ilovelatkesalot!
</code></pre><p>We get a new flag, <code>flag{l33t_l0ckp1ck1ng_br0}</code>, and a key, <code>ilovelatkesalot!</code>. We can use this key to decrypt the information the blog post.</p><h3 id=unknown-encryption class="relative group">Unknown Encryption <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#unknown-encryption aria-label=Anchor>#</a></span></h3><p>On the same blog post where the bike lock is mentioned, Chance also mentions that he encrypted his data using the key he locked:</p><blockquote><p>The information is below, I think I used some sort of Advanced Encryption Algorithm.
1Pm08qXUT64euKHtq1cnN1Ig6yqbT2qWbcSyFnJxYW8MqwZmdGxNW/i5W
+eI98T06iP3LBShWNX65XBBY74FNTp0CL2kOzGJzLSMJ1541XQ3g94VCBW0F
xnAOB5VyP7hLmdSmTC65rHQmsgihW2GXTXicId27OOuUu/QFidbZ6M=</p></blockquote><p>Chance mentions that he used an &ldquo;Advanced Encryption Algorithm&rdquo;, which suggests that he used AES. We can use <a href=https://cyberchef.org target=_blank rel="noreferrer noopener">CyberChef</a> to decrypt this data. Using the key from the Lockpicking Challenge, a random IV, and the mode <code>AES-256-CBC</code>, we get:</p><pre tabindex=0><code>https://drive.google.com/file/d/1sLaQw-kMYGhexxUV12y09RJj_blVLzNz/view?usp=sharing 
flag{f0ll0w_th3_url!}
</code></pre><p>This gives us a flag <code>flag{f0ll0w_th3_url!}</code> and a link to a Google Drive file. This file doesn&rsquo;t open but we can still download it. Using <a href=https://hexed.it/ target=_blank rel="noreferrer noopener">HexEdit</a>, we can see that the file&rsquo;s header is corrupted. We can fix this by changing the first 4 bytes to <code>89 50 4E 47</code>. This allows us to open the image:<figure><img class="mx-auto my-0 rounded-md" srcset="/karst_id_hue2428a1115449a31377b03f163102c3c_474702_330x0_resize_box_3.png 330w,
/karst_id_hue2428a1115449a31377b03f163102c3c_474702_660x0_resize_box_3.png 660w,
/karst_id_hue2428a1115449a31377b03f163102c3c_474702_1024x0_resize_box_3.png 1024w,
/karst_id_hue2428a1115449a31377b03f163102c3c_474702_1320x0_resize_box_3.png 2x" src=/karst_id_hue2428a1115449a31377b03f163102c3c_474702_660x0_resize_box_3.png alt=KarstID></figure></p><p>From this image, we can see that Karst is a private investigator. Therefore, he is probably not the murderer.</p><h3 id=latke-recipe class="relative group">Latke Recipe <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#latke-recipe aria-label=Anchor>#</a></span></h3><p>From the blog, we also find this <a href=latke_recipe.docx>word document</a>. Opening this file gives us a warning, but we cam open it and get a recipe for latkes. Remembering that Docx files are just glorified zip files, we can rename this file to <code>latke_recipe.zip</code> and look for hidden contents. Inside the zip file, we find the flag: <code>flag{00h_l4tk3s!}</code><figure><img class="mx-auto my-0 rounded-md" srcset="/docx_carving_hu4abd755b95cbabd1c03f0a9173ac1cda_40103_330x0_resize_box_3.png 330w,
/docx_carving_hu4abd755b95cbabd1c03f0a9173ac1cda_40103_660x0_resize_box_3.png 660w,
/docx_carving_hu4abd755b95cbabd1c03f0a9173ac1cda_40103_1024x0_resize_box_3.png 1024w,
/docx_carving_hu4abd755b95cbabd1c03f0a9173ac1cda_40103_1320x0_resize_box_3.png 2x" src=/docx_carving_hu4abd755b95cbabd1c03f0a9173ac1cda_40103_660x0_resize_box_3.png alt=carving></figure></p><h3 id=sql-log class="relative group">SQL Log <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#sql-log aria-label=Anchor>#</a></span></h3><p>The last post on Chance&rsquo;s blog gives us a log file of a site that Chance runs. Considering the earlier messages on Twitter, these logs are probably for the Secret Chat site. The logs look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>172.21.0.4 - - <span style=color:#f92672>[</span>14/Mar/2023:00:29:35 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /?user=%27%20ORDER%20BY%201--%20-&amp;pass= HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>224</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (X11; U; Linux i686; es-ES; rv:1.8.1.2) Gecko/20070220 Firefox/2.0.0.2&#34;</span>
</span></span><span style=display:flex><span>172.21.0.4 - - <span style=color:#f92672>[</span>14/Mar/2023:00:29:35 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /?user=%27%20ORDER%20BY%204608--%20-&amp;pass= HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>458</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (X11; U; Linux i686; es-ES; rv:1.8.1.2) Gecko/20070220 Firefox/2.0.0.2&#34;</span>
</span></span><span style=display:flex><span>172.21.0.4 - - <span style=color:#f92672>[</span>14/Mar/2023:00:29:35 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /?user=%27%20ORDER%20BY%2010--%20-&amp;pass= HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>458</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (X11; U; Linux i686; es-ES; rv:1.8.1.2) Gecko/20070220 Firefox/2.0.0.2&#34;</span>
</span></span><span style=display:flex><span>172.21.0.4 - - <span style=color:#f92672>[</span>14/Mar/2023:00:29:35 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /?user=%27%20ORDER%20BY%206--%20-&amp;pass= HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>458</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (X11; U; Linux i686; es-ES; rv:1.8.1.2) Gecko/20070220 Firefox/2.0.0.2&#34;</span>
</span></span></code></pre></div><p>This indicates that a SQL Injection was carried out. In fact, this challenge was actually generated from a SQLmap attack. Looking towards the end of the log, we find that a timing attack was carried out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>172.21.0.4 - - <span style=color:#f92672>[</span>14/Mar/2023:00:35:05 +0000<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /?user=%27%20AND%20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>%28SELECT%207410%20FROM%20%28SELECT%28SLEEP%281-%28IF%28ORD%28MID%28
</span></span></span><span style=display:flex><span><span style=color:#e6db74>%28SELECT%20IFNULL%28CAST%28username%20AS%20NCHAR%29%2C0x20%29%20FROM
</span></span></span><span style=display:flex><span><span style=color:#e6db74>%20admin_site.users%20ORDER%20BY%20id%20LIMIT%201%2C1%29%2C8%2C1%29%29
</span></span></span><span style=display:flex><span><span style=color:#e6db74>%3E113%2C0%2C1%29%29%29%29%29OEDl%29%20AND%20%27ogSF%27%3D%
</span></span></span></code></pre></div><p>Cleaning this up and extracting the sql query we get:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>AND</span> (<span style=color:#66d9ef>SELECT</span> <span style=color:#ae81ff>7410</span> <span style=color:#66d9ef>FROM</span> (<span style=color:#66d9ef>SELECT</span>(SLEEP(<span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>(<span style=color:#66d9ef>IF</span>(ORD(MID((<span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>IFNULL(<span style=color:#66d9ef>CAST</span>(username <span style=color:#66d9ef>AS</span> <span style=color:#66d9ef>NCHAR</span>),<span style=color:#ae81ff>0</span>x20) <span style=color:#66d9ef>FROM</span> admin_site.users 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> id <span style=color:#66d9ef>LIMIT</span> <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>),<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>1</span>))<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>113</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>)))))OEDl) <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;ogSF&#39;</span><span style=color:#f92672>=%</span>
</span></span></code></pre></div><p>This query is checking if the the 8th character of the username is greater than 113. If it is, it will sleep for 1 second. Decoding more of the logs, we see that the attack checks if a character is greater than another number. Then, it decrease the other number until the character is found. After that, it confirms if its guess is correct by checking if it not equal to the character. By looking for any <code>!=</code> signs in the logs, we can find the stolen information:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> urllib.parse <span style=color:#f92672>import</span> unquote
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;access.log&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    lines <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>decoded_data <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> lines:
</span></span><span style=display:flex><span>    request_part <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)[<span style=color:#ae81ff>6</span>]
</span></span><span style=display:flex><span>    decoded_request <span style=color:#f92672>=</span> unquote(request_part)
</span></span><span style=display:flex><span>    char_index <span style=color:#f92672>=</span> decoded_request<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#39;!=&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> char_index <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        temp <span style=color:#f92672>=</span> decoded_request[char_index<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>:char_index<span style=color:#f92672>+</span><span style=color:#ae81ff>5</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(temp[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;,&#39;</span>):
</span></span><span style=display:flex><span>            decoded_data <span style=color:#f92672>+=</span> chr(int(temp[:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            decoded_data <span style=color:#f92672>+=</span> chr(int(temp))
</span></span><span style=display:flex><span>print(decoded_data)
</span></span></code></pre></div><p>This gives us the flag <code>flag{l33t_l0gs_br0}</code>, a username <code>chance</code>, and a password <code>mhm_p0t4t0es</code>. We can use these credentials to log into the Secret Chat site.</p><h2 id=fileshare class="relative group">Fileshare <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#fileshare aria-label=Anchor>#</a></span></h2><p>Using the information (username <code>k4r5t_t0p0gr4phy</code> and password <code>y4z00_tr1but4ry</code>) retrived from Facebook earlier, we look at the files on the Fileshare.</p><h3 id=encrypted-zip class="relative group">Encrypted Zip <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#encrypted-zip aria-label=Anchor>#</a></span></h3><p>We find a zipfile that is encrypted but we don&rsquo;t know the password. There is also a wordlist in the same directory, suggesting that the password is on the wordlist. Therefore, we can use <a href=https://www.openwall.com/john/ target=_blank rel="noreferrer noopener">John The Ripper</a> to crack the password using the wordlist:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>zip2john evidence.zip &gt; hash.txt
</span></span><span style=display:flex><span>john hash.txt --wordlist<span style=color:#f92672>=</span>wordlist.txt
</span></span></code></pre></div><p>This gives us the password <code>mischance</code> which we can use to unzip the file. Inside, we find a file called <code>ChanceEssay.pdf</code> which has the flag <code>flag{h3_r34lly_turn3d_th4t_1n_t0_st4nf0rd}</code>. We also find the file <code>evidence.txt</code> which contains the following:</p><blockquote><p>Good riddance! Chance deserved to go! Why couldn’t he just give me latkes? Who needs to be so protective of latkes?!?!? If he had just given me latkes in the first time, he would still be here. But how am I supposed to get my latkes now??? Maybe I’ll bug CornCob some more. If he doesn’t agree&mldr;</p></blockquote><p>This is a clear confession from the murderer. It also clears Corncob, as the murderer want to &ldquo;bug&rdquo; Corncob. The killer is likely Long, as the motives in this file align with Long&rsquo;s motives. In this folder, we also find some pictures of Chance. So sad to see him go :(</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/chance_profile_hud1d331a38199742527ea214fff3f8335_1789759_330x0_resize_box_3.png 330w,
/chance_profile_hud1d331a38199742527ea214fff3f8335_1789759_660x0_resize_box_3.png 660w,
/chance_profile_hud1d331a38199742527ea214fff3f8335_1789759_1024x0_resize_box_3.png 1024w,
/chance_profile_hud1d331a38199742527ea214fff3f8335_1789759_1320x0_resize_box_3.png 2x" src=/chance_profile_hud1d331a38199742527ea214fff3f8335_1789759_660x0_resize_box_3.png alt=Chance></figure></p><h3 id=spectrogram class="relative group">Spectrogram <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#spectrogram aria-label=Anchor>#</a></span></h3><p>There is also a wav file on the Fileshare. Playing the file hurts your ears and doesn&rsquo;t give any info, so let&rsquo;s try looking at it&rsquo;s spectrogram. The spectrogram is a way to hide messages in an audio file. Opening the file in <a href=https://sonicvisualiser.org/ target=_blank rel="noreferrer noopener">Sonic Visualizer</a>, we get this spectrogram:</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/spectrogram_hua041eaa15c2c876ca839791bd1f3f9fd_423197_330x0_resize_box_3.png 330w,
/spectrogram_hua041eaa15c2c876ca839791bd1f3f9fd_423197_660x0_resize_box_3.png 660w,
/spectrogram_hua041eaa15c2c876ca839791bd1f3f9fd_423197_1024x0_resize_box_3.png 1024w,
/spectrogram_hua041eaa15c2c876ca839791bd1f3f9fd_423197_1320x0_resize_box_3.png 2x" src=/spectrogram_hua041eaa15c2c876ca839791bd1f3f9fd_423197_660x0_resize_box_3.png alt=Spectrogram></figure></p><p>This gives us the flag <code>flag{mus1c_m4j0r5_c4n_h4ck_t00}</code></p><h3 id=pcap-logins class="relative group">PCAP Logins <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pcap-logins aria-label=Anchor>#</a></span></h3><p>Another file on the Fileshare is <code>login.pcap</code>. To analyze it, we can open it in <a href=https://www.wireshark.org/ target=_blank rel="noreferrer noopener">Wireshark</a>. Looking at the HTTP request, we see a lot of 401 Unauthorized responses. However, there is one 200 OK response and clicking &lsquo;Follow Stream&rsquo; on this response gives us a username and password:</p><pre tabindex=0><code>username=long&amp;password=gonl321!!!&amp;666c6167=666c61677b62797465735f6f7665725f7468655f776972657d
</code></pre><p>There is also a hexstring at the end of request. Decoding this hexstring gives us the flag <code>flag{bytes_over_the_wires}</code>. Trying this username and password on all the websites we have found so far, we can log into the Twitter as Long.</p><h4 id=twitter-pt-2 class="relative group">Twitter pt. 2 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#twitter-pt-2 aria-label=Anchor>#</a></span></h4><p>Inside Long&rsquo;s DMs we find that he is begging for latkes from Corncob.</p><blockquote><p>yo CornCob where are my latkes. CORNCOB GIMME YOUR LATKES</p></blockquote><p>This again shows why Long likely killed Chance; he didn&rsquo;t give Long his latkes. We also find that he sent a picture to Hubbz showing himself on vacation.</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/vacation_hu186f1e3eee6a70e4b24559bbf0727ff4_59656_330x0_resize_q75_box.jpg 330w,
/vacation_hu186f1e3eee6a70e4b24559bbf0727ff4_59656_660x0_resize_q75_box.jpg 660w,
/vacation_hu186f1e3eee6a70e4b24559bbf0727ff4_59656_1024x0_resize_q75_box.jpg 1024w,
/vacation_hu186f1e3eee6a70e4b24559bbf0727ff4_59656_1320x0_resize_q75_box.jpg 2x" src=/vacation_hu186f1e3eee6a70e4b24559bbf0727ff4_59656_660x0_resize_q75_box.jpg alt=vacation></figure></p><p>Using <code>exiftool</code> to analyze this image further, we get the following output:</p><pre tabindex=0><code>ExifTool Version Number         : 12.40
File Name                       : vacation.jpg
Directory                       : .
File Size                       : 58 KiB
File Modification Date/Time     : 2023:03:25 22:58:53-04:00
File Access Date/Time           : 2023:03:25 23:01:20-04:00
File Inode Change Date/Time     : 2023:03:25 22:58:53-04:00
File Permissions                : -rwxrwxrwx
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Exif Byte Order                 : Big-endian (Motorola, MM)
X Resolution                    : 144
Y Resolution                    : 144
Resolution Unit                 : inches
Artist                          : ZmxhZ3t3aDR0JzVfMW5fdGgzX2wwYzR0MTBuP30=
User Comment                    : Screenshot
Exif Image Width                : 998
Exif Image Height               : 560
GPS Version ID                  : 0.0.0.1
GPS Latitude Ref                : Unknown (E)
GPS Longitude Ref               : Unknown (S)
Image Width                     : 998
Image Height                    : 560
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 998x560
Megapixels                      : 0.559
GPS Latitude                    : 19 deg 54&#39; 36.96&#34; N
GPS Longitude                   : 155 deg 35&#39; 56.17&#34; E
GPS Position                    : 19 deg 54&#39; 36.96&#34; N, 155 deg 35&#39; 56.17&#34; E
</code></pre><p>Again, there is a base64 string in the Artist field. Decoding this gives us the flag <code>flag{wh4t'5_1n_th3_l0c40n10n?}</code>. This is a hint that we should look at the location of the image. Using <a href=https://www.google.com/maps target=_blank rel="noreferrer noopener">Google Maps</a>, we can find the location of the image.</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/location_hucf8c1e274b35a61bb05bb36768186eeb_586189_330x0_resize_box_3.png 330w,
/location_hucf8c1e274b35a61bb05bb36768186eeb_586189_660x0_resize_box_3.png 660w,
/location_hucf8c1e274b35a61bb05bb36768186eeb_586189_1024x0_resize_box_3.png 1024w,
/location_hucf8c1e274b35a61bb05bb36768186eeb_586189_1320x0_resize_box_3.png 2x" src=/location_hucf8c1e274b35a61bb05bb36768186eeb_586189_660x0_resize_box_3.png alt=Location></figure></p><p>This is in the middle of the ocean, which shows that Long is lying about being on vacation. Therefore, it is still possible that he is the murderer.</p><h3 id=broken-png class="relative group">Broken PNG <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#broken-png aria-label=Anchor>#</a></span></h3><p>Lastly, we find a photo that won&rsquo;t open. Downloading the file and opening it in <a href=https://hexed.it/ target=_blank rel="noreferrer noopener">HexEdit</a>, we find that the first byte of the file is not <code>89</code>, which is required by the PNG standard. Fixing this and saving the file gives us this image:</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/fingerprints_hu4acd827f4d2d5a71e9c74d7c2853d6ca_580285_330x0_resize_box_3.png 330w,
/fingerprints_hu4acd827f4d2d5a71e9c74d7c2853d6ca_580285_660x0_resize_box_3.png 660w,
/fingerprints_hu4acd827f4d2d5a71e9c74d7c2853d6ca_580285_1024x0_resize_box_3.png 1024w,
/fingerprints_hu4acd827f4d2d5a71e9c74d7c2853d6ca_580285_1320x0_resize_box_3.png 2x" src=/fingerprints_hu4acd827f4d2d5a71e9c74d7c2853d6ca_580285_660x0_resize_box_3.png alt=fingerprints></figure></p><p>This image gives us the flag <code>flag{4rch35_l00p5_wh0rl5}</code> and some fingerprints. This can be used with the fingerprints found on the pan that we got from Facebook. By comparing the two, we can confirm that Long is the murderer.</p><p><figure><img class="mx-auto my-0 rounded-md" src=/long_finger.png alt="long finger"></figure><figure><img class="mx-auto my-0 rounded-md" src=/pan_finger.png alt="pan finger"></figure></p><h2 id=virtual-machine class="relative group">Virtual Machine <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#virtual-machine aria-label=Anchor>#</a></span></h2><p>On the Fileshare site, we also find a tarfile of a Virtual Machine. Inside this VM, we find two zip files: <code>history-backup.zip</code> and <code>git-backup.zip</code>.</p><h3 id=chrome-history class="relative group">Chrome History <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#chrome-history aria-label=Anchor>#</a></span></h3><p>Unzipping <code>history-backup.zip</code> gives us the history of a Chrome browsing session. Using <a href=https://www.nirsoft.net/utils/chrome_cache_view.html target=_blank rel="noreferrer noopener">this tool</a> we can look at all the URLs in the browser cache. Looking through the urls, we find this link to some images: <a href=https://imgur.com/a/6pVCTsY target=_blank rel="noreferrer noopener">https://imgur.com/a/6pVCTsY</a>. This again proves that Long is the killer, as he is literally swinging the pan at Chance.</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/pan_swing_hu66a5bad5bb4e2a671eabc94cded98c0f_256821_330x0_resize_q75_box.jpeg 330w,
/pan_swing_hu66a5bad5bb4e2a671eabc94cded98c0f_256821_660x0_resize_q75_box.jpeg 660w,
/pan_swing_hu66a5bad5bb4e2a671eabc94cded98c0f_256821_1024x0_resize_q75_box.jpeg 1024w,
/pan_swing_hu66a5bad5bb4e2a671eabc94cded98c0f_256821_1320x0_resize_q75_box.jpeg 2x" src=/pan_swing_hu66a5bad5bb4e2a671eabc94cded98c0f_256821_660x0_resize_q75_box.jpeg alt=pan_swing></figure></p><h3 id=git-repo class="relative group">Git Repo <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#git-repo aria-label=Anchor>#</a></span></h3><p>We also find a git repo in <code>git-backup.zip</code>. Opening the directory and listing all the files shows nothing. However, if we run <code>git log --graph --decorate --pretty=oneline --abbrev-commit</code> we find that there were a lot of updates to <code>flag.txt</code> and then the file was deleted.</p><p><figure><img class="mx-auto my-0 rounded-md" src=/updates.png alt=updates></figure></p><p>Using <code>git checkout</code> to look at the previous commits, we find that the information is split up into different commits. By going through each commit, we can get the flag <code>flag{g1t_r34ss3mbly}</code> and a confession from Long.</p><blockquote><p>In case you didn&rsquo;t know, I did it >:) &ndash;Long</p></blockquote><p>This proves what our previous evidence hinted at: Long murdered Chance for not giving him latkes.</p><h2 id=secret-chat class="relative group">Secret Chat <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#secret-chat aria-label=Anchor>#</a></span></h2><p>After getting Chance&rsquo;s credentials from the log file on his blog (username: <code>chance</code>, password: <code>mhm_p0t4t0es</code>), we can log into the <a href=https://secret-chat.chals.mcpshsf.com/ target=_blank rel="noreferrer noopener">secret chat</a>. This chat appears to be a group conversation between various members of the Latke Cartel. They appear to be angry at chance for not selling enough latkes.</p><blockquote><p>you need to up your latkes sales
the cartel is LOSING money!!!</p></blockquote><p>While this makes the other cartel members suspicious, we should look further through the chat to see if they have enough motive to kill Chance.</p><h3 id=invisible-message class="relative group">Invisible Message <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#invisible-message aria-label=Anchor>#</a></span></h3><p>Looking through the chat, we find this message:</p><blockquote><p>Nulla pellentesque dignissim enim sit amet venenatis urna cursus eget. Aliquam purus sit amet luctus venenatis lectus. Pellentesque habitant morbi tristique senectus et netus et. Faucibus a pellentesque sit amet. Aliquet bibendum enim facilisis gravida neque convallis a. Ut placerat orci nulla pellentesque. Nisi vitae suscipit tellus mauris a diam maecenas sed enim. Hac habitasse platea dictumst quisque sagittis. Tempor orci dapibus ultrices in iaculis nunc sed. A scelerisque purus semper eget.</p></blockquote><p>This message doesn&rsquo;t seem to contain any information, but if copy it and paste into <a href=https://hexed.it/ target=_blank rel="noreferrer noopener">HexEdit</a>, we can see that there are invisible characters at the end of the message.</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/invisible_hu009295e82975fd63840ec3792d4945c6_212645_330x0_resize_box_3.png 330w,
/invisible_hu009295e82975fd63840ec3792d4945c6_212645_660x0_resize_box_3.png 660w,
/invisible_hu009295e82975fd63840ec3792d4945c6_212645_1024x0_resize_box_3.png 1024w,
/invisible_hu009295e82975fd63840ec3792d4945c6_212645_1320x0_resize_box_3.png 2x" src=/invisible_hu009295e82975fd63840ec3792d4945c6_212645_660x0_resize_box_3.png alt=inivisible.png></figure></p><p>In particular, two invisible characters appear at the end of the message: <code>E1 9E B5</code> and <code>E1 A0 8E</code>. This indicates that a message was encoded in binary. We can convert the first invisible character to a 0 and the second to a 1, and then convert the binary to ASCII to get the flag. This can be done through this script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;invisible.txt&#34;</span>, <span style=color:#e6db74>&#34;rb&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    text <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#34;utf-8&#34;</span>)
</span></span><span style=display:flex><span>text_chars <span style=color:#f92672>=</span> list(text)
</span></span><span style=display:flex><span>binary_chars <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> char <span style=color:#f92672>in</span> text_chars:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ord(char) <span style=color:#f92672>==</span> <span style=color:#ae81ff>6069</span>:
</span></span><span style=display:flex><span>        binary_chars <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> ord(char) <span style=color:#f92672>==</span> <span style=color:#ae81ff>6158</span>:
</span></span><span style=display:flex><span>        binary_chars <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>binary_strings <span style=color:#f92672>=</span> [binary_chars[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>8</span>] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(binary_chars), <span style=color:#ae81ff>8</span>)]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> binary_string <span style=color:#f92672>in</span> binary_strings:
</span></span><span style=display:flex><span>    print(chr(int(binary_string, <span style=color:#ae81ff>2</span>)), end<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>)
</span></span></code></pre></div><p>Pasting the message into <code>invisible.txt</code> and running the script nets us the flag <code>flag{b00_im_a_gh0st_4nd_y0u_c4nt_s33_m3}</code> and Bob&rsquo;s secret message:</p><blockquote><p>chance is so stupid lololol. probably shouldn&rsquo;t even been in this cartel tbh. but i still love him bc he&rsquo;s so nice &lt;3</p></blockquote><p>This clears up the mystery of why Bob was so angry at Chance. He was angry because Chance was stupid and didn&rsquo;t sell enough latkes. This is not enough to kill Chance, however, as Bob still cared about him.</p><h3 id=keyboard-pcap class="relative group">Keyboard PCAP <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#keyboard-pcap aria-label=Anchor>#</a></span></h3><p>Scrolling further through the chat, we also find a link to a <a href=http://chal-host.chals.mcpshsf.com/keylog.pcap target=_blank rel="noreferrer noopener">pcap file</a>. Upon opening this file in <a href=https://www.wireshark.org/ target=_blank rel="noreferrer noopener">Wireshark</a>, we can see that there are a lot of USB packets.</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/usb_packets_hu108b3a4ebe4f5670e8c1e8dfcd512cc0_43262_330x0_resize_box_3.png 330w,
/usb_packets_hu108b3a4ebe4f5670e8c1e8dfcd512cc0_43262_660x0_resize_box_3.png 660w,
/usb_packets_hu108b3a4ebe4f5670e8c1e8dfcd512cc0_43262_1024x0_resize_box_3.png 1024w,
/usb_packets_hu108b3a4ebe4f5670e8c1e8dfcd512cc0_43262_1320x0_resize_box_3.png 2x" src=/usb_packets_hu108b3a4ebe4f5670e8c1e8dfcd512cc0_43262_660x0_resize_box_3.png alt=pcap></figure></p><p>Looking at an individual packet, we can see that keystrokes were sent. We can even see that the first key pressed was a capital <code>D</code>, as the d key and the shift key were pressed.</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/keystroke_hu4c23046c8f6ed0fe1e29ad3e83bb2053_29803_330x0_resize_box_3.png 330w,
/keystroke_hu4c23046c8f6ed0fe1e29ad3e83bb2053_29803_660x0_resize_box_3.png 660w,
/keystroke_hu4c23046c8f6ed0fe1e29ad3e83bb2053_29803_1024x0_resize_box_3.png 1024w,
/keystroke_hu4c23046c8f6ed0fe1e29ad3e83bb2053_29803_1320x0_resize_box_3.png 2x" src=/keystroke_hu4c23046c8f6ed0fe1e29ad3e83bb2053_29803_660x0_resize_box_3.png alt=keystroke></figure></p><p>We could go through each packet and try to figure out what was typed, but this would take a long time. Instead, let&rsquo;s write a script to do it for us. First, let&rsquo;s extract all the usb payloads using tshark.</p><pre tabindex=0><code>tshark -r keylog.pcap -T fields -e usbhid.data &gt; usb_payloads.txt
</code></pre><p>Then, we can write a script to convert the payloads to ASCII.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;usb_payloads.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    lines <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mapping <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;04&#39;</span>: (<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;A&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;05&#39;</span>: (<span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;B&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;06&#39;</span>: (<span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;C&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;07&#39;</span>: (<span style=color:#e6db74>&#39;d&#39;</span>, <span style=color:#e6db74>&#39;D&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;08&#39;</span>: (<span style=color:#e6db74>&#39;e&#39;</span>, <span style=color:#e6db74>&#39;E&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;09&#39;</span>: (<span style=color:#e6db74>&#39;f&#39;</span>, <span style=color:#e6db74>&#39;F&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;0a&#39;</span>: (<span style=color:#e6db74>&#39;g&#39;</span>, <span style=color:#e6db74>&#39;G&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;0b&#39;</span>: (<span style=color:#e6db74>&#39;h&#39;</span>, <span style=color:#e6db74>&#39;H&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;0c&#39;</span>: (<span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;I&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;0d&#39;</span>: (<span style=color:#e6db74>&#39;j&#39;</span>, <span style=color:#e6db74>&#39;J&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;0e&#39;</span>: (<span style=color:#e6db74>&#39;k&#39;</span>, <span style=color:#e6db74>&#39;K&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;0f&#39;</span>: (<span style=color:#e6db74>&#39;l&#39;</span>, <span style=color:#e6db74>&#39;L&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;10&#39;</span>: (<span style=color:#e6db74>&#39;m&#39;</span>, <span style=color:#e6db74>&#39;M&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;11&#39;</span>: (<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;N&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;12&#39;</span>: (<span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;O&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;13&#39;</span>: (<span style=color:#e6db74>&#39;p&#39;</span>, <span style=color:#e6db74>&#39;P&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;14&#39;</span>: (<span style=color:#e6db74>&#39;q&#39;</span>, <span style=color:#e6db74>&#39;Q&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;15&#39;</span>: (<span style=color:#e6db74>&#39;r&#39;</span>, <span style=color:#e6db74>&#39;R&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;16&#39;</span>: (<span style=color:#e6db74>&#39;s&#39;</span>, <span style=color:#e6db74>&#39;S&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;17&#39;</span>: (<span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;T&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;18&#39;</span>: (<span style=color:#e6db74>&#39;u&#39;</span>, <span style=color:#e6db74>&#39;U&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;19&#39;</span>: (<span style=color:#e6db74>&#39;v&#39;</span>, <span style=color:#e6db74>&#39;V&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;1a&#39;</span>: (<span style=color:#e6db74>&#39;w&#39;</span>, <span style=color:#e6db74>&#39;W&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;1b&#39;</span>: (<span style=color:#e6db74>&#39;x&#39;</span>, <span style=color:#e6db74>&#39;X&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;1c&#39;</span>: (<span style=color:#e6db74>&#39;y&#39;</span>, <span style=color:#e6db74>&#39;Y&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;1d&#39;</span>: (<span style=color:#e6db74>&#39;z&#39;</span>, <span style=color:#e6db74>&#39;Z&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;1e&#39;</span>: (<span style=color:#e6db74>&#39;1&#39;</span>, <span style=color:#e6db74>&#39;!&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;1f&#39;</span>: (<span style=color:#e6db74>&#39;2&#39;</span>, <span style=color:#e6db74>&#39;@&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;20&#39;</span>: (<span style=color:#e6db74>&#39;3&#39;</span>, <span style=color:#e6db74>&#39;#&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;21&#39;</span>: (<span style=color:#e6db74>&#39;4&#39;</span>, <span style=color:#e6db74>&#39;$&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;22&#39;</span>: (<span style=color:#e6db74>&#39;5&#39;</span>, <span style=color:#e6db74>&#39;%&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;23&#39;</span>: (<span style=color:#e6db74>&#39;6&#39;</span>, <span style=color:#e6db74>&#39;^&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;24&#39;</span>: (<span style=color:#e6db74>&#39;7&#39;</span>, <span style=color:#e6db74>&#39;&amp;&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;25&#39;</span>: (<span style=color:#e6db74>&#39;8&#39;</span>, <span style=color:#e6db74>&#39;*&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;26&#39;</span>: (<span style=color:#e6db74>&#39;9&#39;</span>, <span style=color:#e6db74>&#39;(&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;27&#39;</span>: (<span style=color:#e6db74>&#39;0&#39;</span>, <span style=color:#e6db74>&#39;)&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;28&#39;</span>: (<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;29&#39;</span>: (<span style=color:#e6db74>&#39;[ESC]&#39;</span>, <span style=color:#e6db74>&#39;[ESC]&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;2a&#39;</span>: (<span style=color:#e6db74>&#39;[BACKSPACE]&#39;</span>, <span style=color:#e6db74>&#39;[BACKSPACE]&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;2b&#39;</span>: (<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;2c&#39;</span>: (<span style=color:#e6db74>&#39; &#39;</span>, <span style=color:#e6db74>&#39; &#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;2d&#39;</span>: (<span style=color:#e6db74>&#39;-&#39;</span>, <span style=color:#e6db74>&#39;_&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;2e&#39;</span>: (<span style=color:#e6db74>&#39;=&#39;</span>, <span style=color:#e6db74>&#39;+&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;2f&#39;</span>: (<span style=color:#e6db74>&#39;[&#39;</span>, <span style=color:#e6db74>&#39;{&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;30&#39;</span>: (<span style=color:#e6db74>&#39;]&#39;</span>, <span style=color:#e6db74>&#39;}&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;31&#39;</span>: (<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;|&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;32&#39;</span>: (<span style=color:#e6db74>&#39;`&#39;</span>, <span style=color:#e6db74>&#39;~&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;33&#39;</span>: (<span style=color:#e6db74>&#39;;&#39;</span>, <span style=color:#e6db74>&#39;:&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;34&#39;</span>: (<span style=color:#e6db74>&#34;&#39;&#34;</span>, <span style=color:#e6db74>&#39;&#34;&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;36&#39;</span>: (<span style=color:#e6db74>&#39;,&#39;</span>, <span style=color:#e6db74>&#39;&lt;&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;37&#39;</span>: (<span style=color:#e6db74>&#39;.&#39;</span>, <span style=color:#e6db74>&#39;&gt;&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;38&#39;</span>: (<span style=color:#e6db74>&#39;/&#39;</span>, <span style=color:#e6db74>&#39;?&#39;</span>), 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;39&#39;</span>: (<span style=color:#e6db74>&#39;[CAPSLOCK]&#39;</span>, <span style=color:#e6db74>&#39;[CAPSLOCK]&#39;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> lines:
</span></span><span style=display:flex><span>    stripped_line <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(stripped_line) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>or</span> stripped_line <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;0000000000000000&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    caps <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> stripped_line[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;2&#39;</span>:
</span></span><span style=display:flex><span>        caps <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    decoded_stroke <span style=color:#f92672>=</span> mapping[stripped_line[<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>6</span>]][caps]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(decoded_stroke <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;[BACKSPACE]&#39;</span>):
</span></span><span style=display:flex><span>        message <span style=color:#f92672>=</span> message[:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        message <span style=color:#f92672>+=</span> decoded_stroke
</span></span><span style=display:flex><span>print(message)
</span></span></code></pre></div><p>Running this script gives us the following message:</p><blockquote><p>Dear Chance, I really miss you. I know you&rsquo;re dead and can&rsquo;t read this but I just wanted to tell you how I feel. I&rsquo;m sorry if I ever made you feel like a bad friend. You were one my BFFs and it&rsquo;s going to be really hard without you. From, corncob
flag{b3_c4r3ful_0f_wh4t_y0u_typ3&mldr;}</p></blockquote><p>What Corncob typed further proves that he is not the murderer. He feels grief over Chance&rsquo;s death and actually misses Chance. We also got another flag from this message: <code>flag{b3_c4r3ful_0f_wh4t_y0u_typ3...}</code></p><h3 id=memory-dump class="relative group">Memory Dump <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#memory-dump aria-label=Anchor>#</a></span></h3><p>Nick says he was drawing something when his computer crashed. He then took this <a href=https://drive.google.com/file/d/1Twp_wsiyxExlnY7qKvWnJh0w2qRQ4wND/view target=_blank rel="noreferrer noopener">memory dump</a>. First, let&rsquo;s determine what processes were running with <a href=https://github.com/volatilityfoundation/volatility3 target=_blank rel="noreferrer noopener">Volatility3</a>. Running the command <code>python vol.py -f memory.dmp windows.pslist.PsList</code> gives us this list of processes:</p><pre tabindex=0><code>PID     PPID    ImageFileName   Offset(V)       Threads Handles SessionId       Wow64   CreateTime      ExitTime       File output

4       0       System  0x84133188      84      488     N/A     False   2023-03-11 02:06:11.000000      N/A     Disabled
228     4       smss.exe        0x919b1140      2       29      N/A     False   2023-03-11 02:06:11.000000      N/A    Disabled
300     292     csrss.exe       0x85cbf3a0      9       370     0       False   2023-03-11 02:06:12.000000      N/A    Disabled
348     292     wininit.exe     0x841ae1d8      3       76      0       False   2023-03-11 02:06:13.000000      N/A    Disabled
360     340     csrss.exe       0x841ae860      8       185     1       False   2023-03-11 02:06:13.000000      N/A    Disabled
400     340     winlogon.exe    0x85cd4d20      3       115     1       False   2023-03-11 02:06:13.000000      N/A    Disabled
444     348     services.exe    0x85ce4558      10      213     0       False   2023-03-11 02:06:13.000000      N/A    Disabled
452     348     lsass.exe       0x85ce6628      7       560     0       False   2023-03-11 02:06:13.000000      N/A    Disabled
460     348     lsm.exe 0x85ce8650      10      141     0       False   2023-03-11 02:06:13.000000      N/A     Disabled
564     444     svchost.exe     0x85d349e0      10      352     0       False   2023-03-11 02:06:13.000000      N/A    Disabled
632     444     svchost.exe     0x93dc8bf8      7       252     0       False   2023-03-11 02:06:13.000000      N/A    Disabled
684     444     svchost.exe     0x85cd5770      18      474     0       False   2023-03-11 02:06:13.000000      N/A    Disabled
804     444     svchost.exe     0x85da2a38      13      311     0       False   2023-03-11 02:06:14.000000      N/A    Disabled
844     444     svchost.exe     0x85db1280      13      331     0       False   2023-03-11 02:06:14.000000      N/A    Disabled
888     444     svchost.exe     0x85dbf030      35      945     0       False   2023-03-11 02:06:14.000000      N/A    Disabled
940     684     audiodg.exe     0x85d5e030      5       120     0       False   2023-03-11 02:06:14.000000      N/A    Disabled
1108    444     svchost.exe     0x85e12510      19      498     0       False   2023-03-11 02:06:15.000000      N/A    Disabled
1204    444     spoolsv.exe     0x85e81510      13      268     0       False   2023-03-11 02:06:15.000000      N/A    Disabled
1240    444     svchost.exe     0x85e86030      19      321     0       False   2023-03-11 02:06:15.000000      N/A    Disabled
1324    444     svchost.exe     0x85e72030      10      145     0       False   2023-03-11 02:06:16.000000      N/A    Disabled
1608    444     svchost.exe     0x8551a568      6       91      0       False   2023-03-11 02:06:17.000000      N/A    Disabled
1940    444     taskhost.exe    0x84bda030      9       246     1       False   2023-03-11 02:06:44.000000      N/A    Disabled
1984    804     dwm.exe 0x8557f250      3       71      1       False   2023-03-11 02:06:44.000000      N/A     Disabled
2000    1976    explorer.exe    0x85581d20      24      778     1       False   2023-03-11 02:06:44.000000      N/A    Disabled
980     444     SearchIndexer.  0x85d92d20      13      623     0       False   2023-03-11 02:06:51.000000      N/A    Disabled
284     444     wmpnetwk.exe    0x86072ab8      9       207     0       False   2023-03-11 02:07:01.000000      N/A    Disabled
1280    444     svchost.exe     0x85eeea68      14      200     0       False   2023-03-11 02:07:01.000000      N/A    Disabled
3128    444     mscorsvw.exe    0x85e9b468      6       76      0       False   2023-03-11 02:08:17.000000      N/A    Disabled
3152    444     sppsvc.exe      0x8612ed20      4       139     0       False   2023-03-11 02:08:17.000000      N/A    Disabled
3192    444     svchost.exe     0x84bddaf0      12      341     0       False   2023-03-11 02:08:17.000000      N/A    Disabled
2548    444     msiexec.exe     0x84566d20      5       273     0       False   2023-03-11 02:13:45.000000      N/A    Disabled
2024    2000    mspaint.exe     0x84260b70      7       143     1       False   2023-03-11 02:20:20.000000      N/A    Disabled
1548    444     svchost.exe     0x8451b9b0      7       105     0       False   2023-03-11 02:20:20.000000      N/A    Disabled
</code></pre><p>Looking through these processes, mspaint appears to be what Nick was drawing in. Let&rsquo;s examine the process by extracting it from the memory dump. We can do this with this command: <code>python vol.py -f memory.dmp windows.memmap.Memmap --pid 2024 --dump</code>. This will create a file called <code>pid.2024.dmp</code> in the current directory.</p><p>We can then use <a href=https://www.gimp.org/ target=_blank rel="noreferrer noopener">Gimp</a> to extract what Nick was drawing. Renaming the file to <code>pid.2024.data</code> and opening it in Gimp, we can adjust the offset, width, and height until we get a viewable image. In this case, an offset of 10652870, width of 960, and height of 350 works.</p><p><figure><img class="mx-auto my-0 rounded-md" srcset="/gimp_hu31da1b87bfbc23c7146b1a76e2f92008_57293_330x0_resize_box_3.png 330w,
/gimp_hu31da1b87bfbc23c7146b1a76e2f92008_57293_660x0_resize_box_3.png 660w,
/gimp_hu31da1b87bfbc23c7146b1a76e2f92008_57293_1024x0_resize_box_3.png 1024w,
/gimp_hu31da1b87bfbc23c7146b1a76e2f92008_57293_1320x0_resize_box_3.png 2x" src=/gimp_hu31da1b87bfbc23c7146b1a76e2f92008_57293_660x0_resize_box_3.png alt=gimp></figure></p><p>Cropping and the flipping the image vertically, we get the following painting:</p><p><figure><img class="mx-auto my-0 rounded-md" src=/painting.png alt=painting></figure></p><p>This gives us the flag <code>flag{wh0_us3s_w1nd0ws7??}</code> and some more information about the Nick. He was drawing a heart for Chance, showing that he cared about him. This means that Nick likely did not murder Chance.</p><h2 id=conclusion class="relative group">Conclusion <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h2><p>Based on all of the evidence, Long is clearly the murderer. Chance&rsquo;s cartel members don&rsquo;t have enough motive to kill him, and actualy cared about him. While Corncob has some motive, there is more evidence suggesting Long was the murderer. Also, Corncob actually feels grief over Chance&rsquo;s death. Long was angry at Chance for not giving him latkes, as shown by his diary and posts on Twitter. His fingerprints line up with the fingerprints on the murder weapon, there is a written confession, and picture of Long murdering Chance. All of these details prove that Long murdered Chance with a pan.</p></div></section><footer class="pt-8 max-w-prose print:hidden"></footer></article><div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2023
Luke Griffith</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher-0 type=button aria-label="appearance switcher"><div class="flex items-center justify-center w-12 h-12 dark:hidden" title="Switch to dark appearance"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden w-12 h-12 dark:flex" title="Switch to light appearance"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://lukegriffith.me><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>